/**
  Copyright (c) 2022-2023 DuoWoA authors
  SPDX-License-Identifier: MIT
**/

#ifndef _SHELL_CODE_H_
#define _SHELL_CODE_H_

STATIC
UINT8
TransferToKernelShellCode[] = {
#if HAS_ACTLR_EL1_UNIMPLEMENTED_ERRATA == 1
  // ACTLR_EL1
  0xEB, 0x03, 0x00, 0xAA, // mov x11, x0
  0x68, 0x0D, 0x41, 0xF8, // ldr x8, [x11, #0x10]!
  0x1F, 0x01, 0x0B, 0xEB, // cmp x8, x11
  0x20, 0x04, 0x00, 0x54, // b.eq 0x00000090
  0x06, 0x05, 0x82, 0x52, // mov w6, #0x1028
  0x06, 0xA7, 0xBA, 0x72, // movk w6, #0xD538, LSL #16
  0x07, 0xFB, 0x9D, 0x52, // mov w7, #0xEFD8
  0xE7, 0x5C, 0xA5, 0x72, // movk w7, #0x2AE7, LSL #16
  0xEA, 0x03, 0x84, 0x52, // mov w10, #0x201F
  0x6A, 0xA0, 0xBA, 0x72, // movk w10, #0xD503, LSL #16
  0x09, 0x01, 0x80, 0x52, // mov w9, #0x8
  0x09, 0x50, 0xBA, 0x72, // movk w9, #0xD280, LSL #16
  0x10, 0x00, 0x00, 0x14, // b 0x00000070
  0x49, 0x00, 0x00, 0xB9, // str w9, [x2]
  0x42, 0x10, 0x00, 0x91, // add x2, x2, #0x4
  0x5F, 0x00, 0x04, 0xEB, // cmp x2, x4
  0x22, 0x01, 0x00, 0x54, // b.cs 0x00000064
  0x43, 0x00, 0x40, 0xB9, // ldr w3, [x2]
  0x7F, 0x00, 0x06, 0x6B, // cmp w3, w6
  0x40, 0xFF, 0xFF, 0x54, // b.eq 0x00000034
  0x63, 0x00, 0x07, 0x0B, // add w3, w3, w7
  0x7F, 0x04, 0x00, 0x71, // cmp w3, #0x1
  0x08, 0xFF, 0xFF, 0x54, // b.hi 0x00000038
  0x4A, 0x00, 0x00, 0xB9, // str w10, [x2]
  0xF6, 0xFF, 0xFF, 0x17, // b 0x00000038
  0x08, 0x01, 0x40, 0xF9, // ldr x8, [x8]
  0x1F, 0x01, 0x0B, 0xEB, // cmp x8, x11
  0x09, 0x00, 0x00, 0x14, // b 0x00000090
  0x02, 0x19, 0x40, 0xF9, // ldr x2, [x8, #0x30]
  0x04, 0x41, 0x40, 0xB9, // ldr w4, [x8, #0x40]
  0x84, 0x00, 0x02, 0x8B, // add x4, x4, x2
  0x5F, 0x00, 0x04, 0xEB, // cmp x2, x4
  0x23, 0xFE, 0xFF, 0x54, // b.cc 0x00000044
  0xF8, 0xFF, 0xFF, 0x17, // b 0x00000064
  0x00, 0x00, 0x00, 0x14, // b 0x00000088
  0x1F, 0x20, 0x03, 0xD5, // nop
#endif

#if HAS_AMCNTENSET0_EL0_UNIMPLEMENTED_ERRATA == 1
  // AMCNTENSET0_EL0
  0xE8, 0x03, 0x00, 0xAA, // mov x8, x0
  0x06, 0x0D, 0x41, 0xF8, // ldr x6, [x8, #0x10]!
  0xDF, 0x00, 0x08, 0xEB, // cmp x6, x8
  0x20, 0x03, 0x00, 0x54, // b.eq 0x00000070
  0x05, 0x55, 0x9A, 0x52, // mov w5, #0xD2A8
  0x65, 0xA7, 0xBA, 0x72, // movk w5, #0xD53B, LSL #16
  0x07, 0x01, 0x80, 0x52, // mov w7, #0x8
  0x07, 0x50, 0xBA, 0x72, // movk w7, #0xD280, LSL #16
  0x0C, 0x00, 0x00, 0x14, // b 0x00000050
  0x42, 0x10, 0x00, 0x91, // add x2, x2, #0x4
  0x5F, 0x00, 0x04, 0xEB, // cmp x2, x4
  0xC2, 0x00, 0x00, 0x54, // b.cs 0x00000044
  0x43, 0x00, 0x40, 0xB9, // ldr w3, [x2]
  0x7F, 0x00, 0x05, 0x6B, // cmp w3, w5
  0x61, 0xFF, 0xFF, 0x54, // b.ne 0x00000024
  0x47, 0x00, 0x00, 0xB9, // str w7, [x2]
  0xF9, 0xFF, 0xFF, 0x17, // b 0x00000024
  0xC6, 0x00, 0x40, 0xF9, // ldr x6, [x6]
  0xDF, 0x00, 0x08, 0xEB, // cmp x6, x8
  0x09, 0x00, 0x00, 0x14, // b 0x00000070
  0xC2, 0x18, 0x40, 0xF9, // ldr x2, [x6, #0x30]
  0xC4, 0x40, 0x40, 0xB9, // ldr w4, [x6, #0x40]
  0x84, 0x00, 0x02, 0x8B, // add x4, x4, x2
  0x5F, 0x00, 0x04, 0xEB, // cmp x2, x4
  0x83, 0xFE, 0xFF, 0x54, // b.cc 0x00000030
  0xF8, 0xFF, 0xFF, 0x17, // b 0x00000044
  0x00, 0x00, 0x00, 0x14, // b 0x00000068
  0x1F, 0x20, 0x03, 0xD5, // nop
#endif

#if HAS_GIC_V3_WITHOUT_IRM_FLAG_SUPPORT_ERRATA == 1
  // IRM
  0xEA, 0x03, 0x00, 0xAA, // mov x10, x0
  0x49, 0x0D, 0x41, 0xF8, // ldr x9, [x10, #0x10]!
  0x3F, 0x01, 0x0A, 0xEB, // cmp x9, x10
  0xA0, 0x0C, 0x00, 0x54, // b.eq 0x000001A0
  0x03, 0x00, 0x80, 0xD2, // mov x3, #0x0
  0x04, 0x00, 0x80, 0xD2, // mov x4, #0x0
  0x48, 0x75, 0x99, 0x52, // mov w8, #0xCBAA
  0x08, 0xA3, 0xBA, 0x72, // movk w8, #0xD518, LSL #16
  0x67, 0x00, 0x80, 0xD2, // mov x7, #0x3
  0x27, 0x01, 0xA0, 0xF2, // movk x7, #0x9, LSL #16
  0xC7, 0x02, 0xC0, 0xF2, // movk x7, #0x16, LSL #32
  0x27, 0x01, 0xE0, 0xF2, // movk x7, #0x9, LSL #48
  0x04, 0x00, 0x00, 0x14, // b 0x00000040
  0x29, 0x01, 0x40, 0xF9, // ldr x9, [x9]
  0x3F, 0x01, 0x0A, 0xEB, // cmp x9, x10
  0x13, 0x00, 0x00, 0x14, // b 0x00000088
  0x22, 0x19, 0x40, 0xF9, // ldr x2, [x9, #0x30]
  0x26, 0x41, 0x40, 0xB9, // ldr w6, [x9, #0x40]
  0xC6, 0x00, 0x02, 0x8B, // add x6, x6, x2
  0x5F, 0x00, 0x06, 0xEB, // cmp x2, x6
  0x22, 0xFF, 0xFF, 0x54, // b.cs 0x00000034
  0x45, 0x00, 0x40, 0xB9, // ldr w5, [x2]
  0xBF, 0x00, 0x08, 0x6B, // cmp w5, w8
  0x84, 0x10, 0x82, 0x9A, // csel x4, x4, x2, ne
  0x45, 0x00, 0x40, 0xF9, // ldr x5, [x2]
  0xBF, 0x00, 0x07, 0xEB, // cmp x5, x7
  0x63, 0x10, 0x82, 0x9A, // csel x3, x3, x2, ne
  0x9F, 0x00, 0x00, 0xF1, // cmp x4, #0x0
  0x64, 0x18, 0x40, 0xFA, // ccmp x3, #0x0, #0x4, ne
  0x01, 0xFE, 0xFF, 0x54, // b.ne 0x00000034
  0x42, 0x10, 0x00, 0x91, // add x2, x2, #0x4
  0x5F, 0x00, 0x06, 0xEB, // cmp x2, x6
  0xA3, 0xFE, 0xFF, 0x54, // b.cc 0x00000054
  0xEC, 0xFF, 0xFF, 0x17, // b 0x00000034
  0x9F, 0x00, 0x00, 0xF1, // cmp x4, #0x0
  0x64, 0x18, 0x40, 0xFA, // ccmp x3, #0x0, #0x4, ne
  0x80, 0x08, 0x00, 0x54, // b.eq 0x000001A0
  0x62, 0xA0, 0x02, 0xD1, // sub x2, x3, #0xA8
  0x42, 0x00, 0x04, 0xCB, // sub x2, x2, x4
  0x42, 0x6C, 0x02, 0x53, // ubfx w2, w2, #0x2, #0x1A
  0x05, 0x80, 0xB2, 0x52, // mov w5, #0x94000000
  0x42, 0x00, 0x05, 0x2A, // orr w2, w2, w5
  0x82, 0x00, 0x00, 0xB9, // str w2, [x4]
  0xA2, 0x7F, 0x8F, 0xD2, // mov x2, #0x7BFD
  0xE2, 0x37, 0xB5, 0xF2, // movk x2, #0xA9BF, LSL #16
  0xA2, 0x7F, 0xC0, 0xF2, // movk x2, #0x3FD, LSL #32
  0x02, 0x20, 0xF2, 0xF2, // movk x2, #0x9100, LSL #48
  0x62, 0x80, 0x15, 0xF8, // stur x2, [x3, #-0xA8]
  0x42, 0x49, 0x80, 0xD2, // mov x2, #0x24A
  0x02, 0xC8, 0xB6, 0xF2, // movk x2, #0xB640, LSL #16
  0x42, 0x29, 0xDF, 0xF2, // movk x2, #0xF94A, LSL #32
  0xE2, 0x4A, 0xF2, 0xF2, // movk x2, #0x9257, LSL #48
  0x62, 0x00, 0x16, 0xF8, // stur x2, [x3, #-0xA0]
  0x42, 0x29, 0x80, 0xD2, // mov x2, #0x14A
  0x02, 0x48, 0xB6, 0xF2, // movk x2, #0xB240, LSL #16
  0xC2, 0x7E, 0xC0, 0xF2, // movk x2, #0x3F6, LSL #32
  0x42, 0x41, 0xF5, 0xF2, // movk x2, #0xAA0A, LSL #48
  0x62, 0x80, 0x16, 0xF8, // stur x2, [x3, #-0x98]
  0x22, 0x15, 0x80, 0xD2, // mov x2, #0xA9
  0x02, 0xA7, 0xBA, 0xF2, // movk x2, #0xD538, LSL #16
  0x22, 0xA5, 0xC1, 0xF2, // movk x2, #0xD29, LSL #32
  0x02, 0x4F, 0xF2, 0xF2, // movk x2, #0x9278, LSL #48
  0x62, 0x00, 0x17, 0xF8, // stur x2, [x3, #-0x90]
  0x82, 0x02, 0x80, 0xD2, // mov x2, #0x14
  0x02, 0x50, 0xBA, 0xF2, // movk x2, #0xD280, LSL #16
  0xA2, 0x22, 0xC0, 0xF2, // movk x2, #0x115, LSL #32
  0x02, 0x50, 0xEA, 0xF2, // movk x2, #0x5280, LSL #48
  0x62, 0x80, 0x17, 0xF8, // stur x2, [x3, #-0x88]
  0xE2, 0x53, 0x84, 0xD2, // mov x2, #0x229F
  0x22, 0x69, 0xBD, 0xF2, // movk x2, #0xEB49, LSL #16
  0x02, 0x14, 0xC0, 0xF2, // movk x2, #0xA0, LSL #32
  0x02, 0x80, 0xEA, 0xF2, // movk x2, #0x5400, LSL #48
  0x62, 0x00, 0x18, 0xF8, // stur x2, [x3, #-0x80]
  0x02, 0xD1, 0x97, 0xD2, // mov x2, #0xBE88
  0x02, 0x6E, 0xBA, 0xF2, // movk x2, #0xD370, LSL #16
  0x42, 0x59, 0xC0, 0xF2, // movk x2, #0x2CA, LSL #32
  0x02, 0x41, 0xF5, 0xF2, // movk x2, #0xAA08, LSL #48
  0x62, 0x80, 0x18, 0xF8, // stur x2, [x3, #-0x78]
  0x42, 0x75, 0x99, 0xD2, // mov x2, #0xCBAA
  0x02, 0xA3, 0xBA, 0xF2, // movk x2, #0xD518, LSL #16
  0xE2, 0xF3, 0xC7, 0xF2, // movk x2, #0x3F9F, LSL #32
  0x62, 0xA0, 0xFA, 0xF2, // movk x2, #0xD503, LSL #48
  0x62, 0x00, 0x19, 0xF8, // stur x2, [x3, #-0x70]
  0x82, 0xD2, 0x80, 0xD2, // mov x2, #0x694
  0x02, 0x20, 0xB2, 0xF2, // movk x2, #0x9100, LSL #16
  0xA2, 0xD6, 0xC0, 0xF2, // movk x2, #0x6B5, LSL #32
  0x02, 0x20, 0xEA, 0xF2, // movk x2, #0x5100, LSL #48
  0x62, 0x80, 0x19, 0xF8, // stur x2, [x3, #-0x68]
  0xA2, 0xE2, 0x9F, 0xD2, // mov x2, #0xFF15
  0xE2, 0xBF, 0xA6, 0xF2, // movk x2, #0x35FF, LSL #16
  0x42, 0x00, 0xC0, 0xF2, // movk x2, #0x2, LSL #32
  0x02, 0x80, 0xE2, 0xF2, // movk x2, #0x1400, LSL #48
  0x62, 0x00, 0x1A, 0xF8, // stur x2, [x3, #-0x60]
  0x42, 0x75, 0x99, 0xD2, // mov x2, #0xCBAA
  0x02, 0xA3, 0xBA, 0xF2, // movk x2, #0xD518, LSL #16
  0xA2, 0x7F, 0xCF, 0xF2, // movk x2, #0x7BFD, LSL #32
  0x22, 0x18, 0xF5, 0xF2, // movk x2, #0xA8C1, LSL #48
  0x62, 0x80, 0x1A, 0xF8, // stur x2, [x3, #-0x58]
  0x02, 0x78, 0x80, 0x52, // mov w2, #0x3C0
  0xE2, 0xCB, 0xBA, 0x72, // movk w2, #0xD65F, LSL #16
  0x62, 0x00, 0x1B, 0xB8, // stur w2, [x3, #-0x50]
  0x1F, 0x20, 0x03, 0xD5, // nop
  0x1F, 0x20, 0x03, 0xD5, // nop
  0x1F, 0x20, 0x03, 0xD5, // nop

  // IRM_X8
  0xEA, 0x03, 0x00, 0xAA, // mov x10, x0
  0x49, 0x0D, 0x41, 0xF8, // ldr x9, [x10, #0x10]!
  0x3F, 0x01, 0x0A, 0xEB, // cmp x9, x10
  0xA0, 0x0C, 0x00, 0x54, // b.eq 0x000001A0
  0x03, 0x00, 0x80, 0xD2, // mov x3, #0x0
  0x04, 0x00, 0x80, 0xD2, // mov x4, #0x0
  0x08, 0x75, 0x99, 0x52, // mov w8, #0xCBA8
  0x08, 0xA3, 0xBA, 0x72, // movk w8, #0xD518, LSL #16
  0x67, 0x00, 0x80, 0xD2, // mov x7, #0x3
  0x27, 0x01, 0xA0, 0xF2, // movk x7, #0x9, LSL #16
  0xC7, 0x02, 0xC0, 0xF2, // movk x7, #0x16, LSL #32
  0x27, 0x01, 0xE0, 0xF2, // movk x7, #0x9, LSL #48
  0x04, 0x00, 0x00, 0x14, // b 0x00000040
  0x29, 0x01, 0x40, 0xF9, // ldr x9, [x9]
  0x3F, 0x01, 0x0A, 0xEB, // cmp x9, x10
  0x13, 0x00, 0x00, 0x14, // b 0x00000088
  0x22, 0x19, 0x40, 0xF9, // ldr x2, [x9, #0x30]
  0x26, 0x41, 0x40, 0xB9, // ldr w6, [x9, #0x40]
  0xC6, 0x00, 0x02, 0x8B, // add x6, x6, x2
  0x5F, 0x00, 0x06, 0xEB, // cmp x2, x6
  0x22, 0xFF, 0xFF, 0x54, // b.cs 0x00000034
  0x45, 0x00, 0x40, 0xB9, // ldr w5, [x2]
  0xBF, 0x00, 0x08, 0x6B, // cmp w5, w8
  0x84, 0x10, 0x82, 0x9A, // csel x4, x4, x2, ne
  0x45, 0x00, 0x40, 0xF9, // ldr x5, [x2]
  0xBF, 0x00, 0x07, 0xEB, // cmp x5, x7
  0x63, 0x10, 0x82, 0x9A, // csel x3, x3, x2, ne
  0x9F, 0x00, 0x00, 0xF1, // cmp x4, #0x0
  0x64, 0x18, 0x40, 0xFA, // ccmp x3, #0x0, #0x4, ne
  0x01, 0xFE, 0xFF, 0x54, // b.ne 0x00000034
  0x42, 0x10, 0x00, 0x91, // add x2, x2, #0x4
  0x5F, 0x00, 0x06, 0xEB, // cmp x2, x6
  0xA3, 0xFE, 0xFF, 0x54, // b.cc 0x00000054
  0xEC, 0xFF, 0xFF, 0x17, // b 0x00000034
  0x9F, 0x00, 0x00, 0xF1, // cmp x4, #0x0
  0x64, 0x18, 0x40, 0xFA, // ccmp x3, #0x0, #0x4, ne
  0x80, 0x08, 0x00, 0x54, // b.eq 0x000001A0
  0x62, 0xA0, 0x02, 0xD1, // sub x2, x3, #0xA8
  0x42, 0x00, 0x04, 0xCB, // sub x2, x2, x4
  0x42, 0x6C, 0x02, 0x53, // ubfx w2, w2, #0x2, #0x1A
  0x05, 0x80, 0xB2, 0x52, // mov w5, #0x94000000
  0x42, 0x00, 0x05, 0x2A, // orr w2, w2, w5
  0x82, 0x00, 0x00, 0xB9, // str w2, [x4]
  0xA2, 0x7F, 0x8F, 0xD2, // mov x2, #0x7BFD
  0xE2, 0x37, 0xB5, 0xF2, // movk x2, #0xA9BF, LSL #16
  0xA2, 0x7F, 0xC0, 0xF2, // movk x2, #0x3FD, LSL #32
  0x02, 0x20, 0xF2, 0xF2, // movk x2, #0x9100, LSL #48
  0x62, 0x80, 0x15, 0xF8, // stur x2, [x3, #-0xA8]
  0x02, 0x49, 0x80, 0xD2, // mov x2, #0x248
  0x02, 0xC8, 0xB6, 0xF2, // movk x2, #0xB640, LSL #16
  0x02, 0x21, 0xDF, 0xF2, // movk x2, #0xF908, LSL #32
  0xE2, 0x4A, 0xF2, 0xF2, // movk x2, #0x9257, LSL #48
  0x62, 0x00, 0x16, 0xF8, // stur x2, [x3, #-0xA0]
  0x02, 0x21, 0x80, 0xD2, // mov x2, #0x108
  0x02, 0x48, 0xB6, 0xF2, // movk x2, #0xB240, LSL #16
  0xC2, 0x7E, 0xC0, 0xF2, // movk x2, #0x3F6, LSL #32
  0x02, 0x41, 0xF5, 0xF2, // movk x2, #0xAA08, LSL #48
  0x62, 0x80, 0x16, 0xF8, // stur x2, [x3, #-0x98]
  0x22, 0x15, 0x80, 0xD2, // mov x2, #0xA9
  0x02, 0xA7, 0xBA, 0xF2, // movk x2, #0xD538, LSL #16
  0x22, 0xA5, 0xC1, 0xF2, // movk x2, #0xD29, LSL #32
  0x02, 0x4F, 0xF2, 0xF2, // movk x2, #0x9278, LSL #48
  0x62, 0x00, 0x17, 0xF8, // stur x2, [x3, #-0x90]
  0x82, 0x02, 0x80, 0xD2, // mov x2, #0x14
  0x02, 0x50, 0xBA, 0xF2, // movk x2, #0xD280, LSL #16
  0xA2, 0x22, 0xC0, 0xF2, // movk x2, #0x115, LSL #32
  0x02, 0x50, 0xEA, 0xF2, // movk x2, #0x5280, LSL #48
  0x62, 0x80, 0x17, 0xF8, // stur x2, [x3, #-0x88]
  0xE2, 0x53, 0x84, 0xD2, // mov x2, #0x229F
  0x22, 0x69, 0xBD, 0xF2, // movk x2, #0xEB49, LSL #16
  0x02, 0x14, 0xC0, 0xF2, // movk x2, #0xA0, LSL #32
  0x02, 0x80, 0xEA, 0xF2, // movk x2, #0x5400, LSL #48
  0x62, 0x00, 0x18, 0xF8, // stur x2, [x3, #-0x80]
  0x42, 0xD1, 0x97, 0xD2, // mov x2, #0xBE8A
  0x02, 0x6E, 0xBA, 0xF2, // movk x2, #0xD370, LSL #16
  0x02, 0x59, 0xC0, 0xF2, // movk x2, #0x2C8, LSL #32
  0x42, 0x41, 0xF5, 0xF2, // movk x2, #0xAA0A, LSL #48
  0x62, 0x80, 0x18, 0xF8, // stur x2, [x3, #-0x78]
  0x02, 0x75, 0x99, 0xD2, // mov x2, #0xCBA8
  0x02, 0xA3, 0xBA, 0xF2, // movk x2, #0xD518, LSL #16
  0xE2, 0xF3, 0xC7, 0xF2, // movk x2, #0x3F9F, LSL #32
  0x62, 0xA0, 0xFA, 0xF2, // movk x2, #0xD503, LSL #48
  0x62, 0x00, 0x19, 0xF8, // stur x2, [x3, #-0x70]
  0x82, 0xD2, 0x80, 0xD2, // mov x2, #0x694
  0x02, 0x20, 0xB2, 0xF2, // movk x2, #0x9100, LSL #16
  0xA2, 0xD6, 0xC0, 0xF2, // movk x2, #0x6B5, LSL #32
  0x02, 0x20, 0xEA, 0xF2, // movk x2, #0x5100, LSL #48
  0x62, 0x80, 0x19, 0xF8, // stur x2, [x3, #-0x68]
  0xA2, 0xE2, 0x9F, 0xD2, // mov x2, #0xFF15
  0xE2, 0xBF, 0xA6, 0xF2, // movk x2, #0x35FF, LSL #16
  0x42, 0x00, 0xC0, 0xF2, // movk x2, #0x2, LSL #32
  0x02, 0x80, 0xE2, 0xF2, // movk x2, #0x1400, LSL #48
  0x62, 0x00, 0x1A, 0xF8, // stur x2, [x3, #-0x60]
  0x02, 0x75, 0x99, 0xD2, // mov x2, #0xCBA8
  0x02, 0xA3, 0xBA, 0xF2, // movk x2, #0xD518, LSL #16
  0xA2, 0x7F, 0xCF, 0xF2, // movk x2, #0x7BFD, LSL #32
  0x22, 0x18, 0xF5, 0xF2, // movk x2, #0xA8C1, LSL #48
  0x62, 0x80, 0x1A, 0xF8, // stur x2, [x3, #-0x58]
  0x02, 0x78, 0x80, 0x52, // mov w2, #0x3C0
  0xE2, 0xCB, 0xBA, 0x72, // movk w2, #0xD65F, LSL #16
  0x62, 0x00, 0x1B, 0xB8, // stur w2, [x3, #-0x50]
  0x1F, 0x20, 0x03, 0xD5, // nop
  0x1F, 0x20, 0x03, 0xD5, // nop
  0x1F, 0x20, 0x03, 0xD5, // nop
#endif

#if HAS_PSCI_MEMPROTECT_FAILING_ERRATA == 1
  // PSCI_MEMPROTECT
  0xEC, 0x03, 0x00, 0xAA, // mov x12, x0
  0x88, 0x0D, 0x41, 0xF8, // ldr x8, [x12, #0x10]!
  0x1F, 0x01, 0x0C, 0xEB, // cmp x8, x12
  0x20, 0x06, 0x00, 0x54, // b.eq 0x000000D0
  0xA6, 0x5A, 0x80, 0xD2, // mov x6, #0x2D5
  0x06, 0x00, 0xA3, 0xF2, // movk x6, #0x1800, LSL #16
  0x66, 0x00, 0xC0, 0xF2, // movk x6, #0x3, LSL #32
  0x06, 0x50, 0xFA, 0xF2, // movk x6, #0xD280, LSL #48
  0x67, 0x00, 0x80, 0xD2, // mov x7, #0x3
  0x07, 0x50, 0xBA, 0xF2, // movk x7, #0xD280, LSL #16
  0x47, 0x00, 0xC0, 0xF2, // movk x7, #0x2, LSL #32
  0x07, 0x50, 0xFA, 0xF2, // movk x7, #0xD280, LSL #48
  0x2A, 0x00, 0x80, 0xD2, // mov x10, #0x1
  0x0A, 0x50, 0xBA, 0xF2, // movk x10, #0xD280, LSL #16
  0x0A, 0x48, 0xC0, 0xF2, // movk x10, #0x240, LSL #32
  0x0A, 0x00, 0xE3, 0xF2, // movk x10, #0x1800, LSL #48
  0x0B, 0x78, 0x80, 0x52, // mov w11, #0x3C0
  0xEB, 0xCB, 0xBA, 0x72, // movk w11, #0xD65F, LSL #16
  0x49, 0x00, 0x80, 0xD2, // mov x9, #0x2
  0x09, 0x50, 0xBA, 0xF2, // movk x9, #0xD280, LSL #16
  0x29, 0x00, 0xC0, 0xF2, // movk x9, #0x1, LSL #32
  0x09, 0x50, 0xFA, 0xF2, // movk x9, #0xD280, LSL #48
  0x17, 0x00, 0x00, 0x14, // b 0x000000B4
  0x43, 0x04, 0x40, 0xF9, // ldr x3, [x2, #0x8]
  0x7F, 0x00, 0x09, 0xEB, // cmp x3, x9
  0xE0, 0x01, 0x00, 0x54, // b.eq 0x000000A0
  0x42, 0x10, 0x00, 0x91, // add x2, x2, #0x4
  0x5F, 0x00, 0x05, 0xEB, // cmp x2, x5
  0xC2, 0x01, 0x00, 0x54, // b.cs 0x000000A8
  0x43, 0x00, 0x40, 0xF9, // ldr x3, [x2]
  0x7F, 0x00, 0x06, 0xEB, // cmp x3, x6
  0x00, 0xFF, 0xFF, 0x54, // b.eq 0x0000005C
  0x7F, 0x00, 0x07, 0xEB, // cmp x3, x7
  0x21, 0xFF, 0xFF, 0x54, // b.ne 0x00000068
  0x43, 0x04, 0x40, 0xF9, // ldr x3, [x2, #0x8]
  0x63, 0xF8, 0x58, 0x92, // and x3, x3, #-0x8000000001
  0x7F, 0x00, 0x0A, 0xEB, // cmp x3, x10
  0xA1, 0xFE, 0xFF, 0x54, // b.ne 0x00000068
  0x4B, 0x40, 0x1E, 0xB8, // stur w11, [x2, #-0x1C]
  0xF3, 0xFF, 0xFF, 0x17, // b 0x00000068
  0x4B, 0x00, 0x1E, 0xB8, // stur w11, [x2, #-0x20]
  0xF1, 0xFF, 0xFF, 0x17, // b 0x00000068
  0x08, 0x01, 0x40, 0xF9, // ldr x8, [x8]
  0x1F, 0x01, 0x0C, 0xEB, // cmp x8, x12
  0x08, 0x00, 0x00, 0x14, // b 0x000000D0
  0x02, 0x19, 0x40, 0xF9, // ldr x2, [x8, #0x30]
  0x05, 0x41, 0x40, 0xB9, // ldr w5, [x8, #0x40]
  0xA5, 0x00, 0x02, 0x8B, // add x5, x5, x2
  0x5F, 0x00, 0x05, 0xEB, // cmp x2, x5
  0x83, 0xFD, 0xFF, 0x54, // b.cc 0x00000074
  0xF8, 0xFF, 0xFF, 0x17, // b 0x000000A8
  0x00, 0x00, 0x00, 0x14  // b 0x000000CC
#endif
};

#endif /* _SHELL_CODE_H_ */
